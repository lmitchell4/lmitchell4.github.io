<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Statistical tests | _main.utf8.md</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Statistical tests | _main.utf8.md" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Statistical tests | _main.utf8.md" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="probability-distributions.html"/>
<link rel="next" href="statistical-modeling-overview.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#getting-help"><i class="fa fa-check"></i><b>1.1</b> Getting help</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#this-is-version-1.0"><i class="fa fa-check"></i><b>1.2</b> This is Version 1.0</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>2</b> Summarizing data</a><ul>
<li class="chapter" data-level="2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#overview"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="summarizing-data.html"><a href="summarizing-data.html#descriptive-statistics"><i class="fa fa-check"></i><b>2.2</b> Descriptive statistics</a></li>
<li class="chapter" data-level="2.3" data-path="summarizing-data.html"><a href="summarizing-data.html#data-visualization"><i class="fa fa-check"></i><b>2.3</b> Data visualization</a><ul>
<li class="chapter" data-level="2.3.1" data-path="summarizing-data.html"><a href="summarizing-data.html#visualizing-the-distribution-of-one-variable"><i class="fa fa-check"></i><b>2.3.1</b> Visualizing the distribution of one variable</a></li>
<li class="chapter" data-level="2.3.2" data-path="summarizing-data.html"><a href="summarizing-data.html#visualizing-two-variables"><i class="fa fa-check"></i><b>2.3.2</b> Visualizing two variables</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="summarizing-data.html"><a href="summarizing-data.html#publication-quality-graphics"><i class="fa fa-check"></i><b>2.4</b> Publication quality graphics</a><ul>
<li class="chapter" data-level="2.4.1" data-path="summarizing-data.html"><a href="summarizing-data.html#par"><i class="fa fa-check"></i><b>2.4.1</b> par</a></li>
<li class="chapter" data-level="2.4.2" data-path="summarizing-data.html"><a href="summarizing-data.html#annotations"><i class="fa fa-check"></i><b>2.4.2</b> Annotations</a></li>
<li class="chapter" data-level="2.4.3" data-path="summarizing-data.html"><a href="summarizing-data.html#exporting-graphics"><i class="fa fa-check"></i><b>2.4.3</b> Exporting graphics</a></li>
<li class="chapter" data-level="2.4.4" data-path="summarizing-data.html"><a href="summarizing-data.html#other-resources"><i class="fa fa-check"></i><b>2.4.4</b> Other resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probability-distributions.html"><a href="probability-distributions.html"><i class="fa fa-check"></i><b>3</b> Probability distributions</a><ul>
<li class="chapter" data-level="3.1" data-path="probability-distributions.html"><a href="probability-distributions.html#probability"><i class="fa fa-check"></i><b>3.1</b> Probability</a></li>
<li class="chapter" data-level="3.2" data-path="probability-distributions.html"><a href="probability-distributions.html#sampling"><i class="fa fa-check"></i><b>3.2</b> Sampling</a></li>
<li class="chapter" data-level="3.3" data-path="probability-distributions.html"><a href="probability-distributions.html#common-probability-distributions"><i class="fa fa-check"></i><b>3.3</b> Common probability distributions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistical-tests.html"><a href="statistical-tests.html"><i class="fa fa-check"></i><b>4</b> Statistical tests</a><ul>
<li class="chapter" data-level="4.1" data-path="statistical-tests.html"><a href="statistical-tests.html#overview-1"><i class="fa fa-check"></i><b>4.1</b> Overview</a><ul>
<li class="chapter" data-level="4.1.1" data-path="statistical-tests.html"><a href="statistical-tests.html#large-sample-hypothesis-testing-with-a-normally-distributed-estimator"><i class="fa fa-check"></i><b>4.1.1</b> Large sample hypothesis testing with a normally distributed estimator</a></li>
<li class="chapter" data-level="4.1.2" data-path="statistical-tests.html"><a href="statistical-tests.html#general-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.2</b> General hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="statistical-tests.html"><a href="statistical-tests.html#single-sample-tests"><i class="fa fa-check"></i><b>4.2</b> Single sample tests</a><ul>
<li class="chapter" data-level="4.2.1" data-path="statistical-tests.html"><a href="statistical-tests.html#tests-for-population-mean-and-variance"><i class="fa fa-check"></i><b>4.2.1</b> Tests for population mean and variance</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistical-tests.html"><a href="statistical-tests.html#tests-for-normality"><i class="fa fa-check"></i><b>4.2.2</b> Tests for normality</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistical-tests.html"><a href="statistical-tests.html#two-sample-tests"><i class="fa fa-check"></i><b>4.3</b> Two sample tests</a></li>
<li class="chapter" data-level="4.4" data-path="statistical-tests.html"><a href="statistical-tests.html#contingency-tables"><i class="fa fa-check"></i><b>4.4</b> Contingency tables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistical-modeling-overview.html"><a href="statistical-modeling-overview.html"><i class="fa fa-check"></i><b>5</b> Statistical modeling overview</a><ul>
<li class="chapter" data-level="5.1" data-path="statistical-modeling-overview.html"><a href="statistical-modeling-overview.html#why-fit-a-model"><i class="fa fa-check"></i><b>5.1</b> Why fit a model?</a></li>
<li class="chapter" data-level="5.2" data-path="statistical-modeling-overview.html"><a href="statistical-modeling-overview.html#getting-started"><i class="fa fa-check"></i><b>5.2</b> Getting started</a></li>
<li class="chapter" data-level="5.3" data-path="statistical-modeling-overview.html"><a href="statistical-modeling-overview.html#overview-of-methods"><i class="fa fa-check"></i><b>5.3</b> Overview of methods</a></li>
<li class="chapter" data-level="5.4" data-path="statistical-modeling-overview.html"><a href="statistical-modeling-overview.html#estimation-methods"><i class="fa fa-check"></i><b>5.4</b> Estimation methods</a><ul>
<li class="chapter" data-level="5.4.1" data-path="statistical-modeling-overview.html"><a href="statistical-modeling-overview.html#least-squares"><i class="fa fa-check"></i><b>5.4.1</b> Least squares</a></li>
<li class="chapter" data-level="5.4.2" data-path="statistical-modeling-overview.html"><a href="statistical-modeling-overview.html#maximum-likelihood"><i class="fa fa-check"></i><b>5.4.2</b> Maximum likelihood</a></li>
<li class="chapter" data-level="5.4.3" data-path="statistical-modeling-overview.html"><a href="statistical-modeling-overview.html#important-considerations"><i class="fa fa-check"></i><b>5.4.3</b> Important considerations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-general-linear-models.html"><a href="ch-general-linear-models.html"><i class="fa fa-check"></i><b>6</b> General linear models</a><ul>
<li class="chapter" data-level="6.1" data-path="ch-general-linear-models.html"><a href="ch-general-linear-models.html#definitions-and-assumptions"><i class="fa fa-check"></i><b>6.1</b> Definitions and assumptions</a></li>
<li class="chapter" data-level="6.2" data-path="ch-general-linear-models.html"><a href="ch-general-linear-models.html#regression-anova-and-ancova"><i class="fa fa-check"></i><b>6.2</b> Regression, ANOVA, and ANCOVA</a></li>
<li class="chapter" data-level="6.3" data-path="ch-general-linear-models.html"><a href="ch-general-linear-models.html#data-standardization"><i class="fa fa-check"></i><b>6.3</b> Data standardization</a></li>
<li class="chapter" data-level="6.4" data-path="ch-general-linear-models.html"><a href="ch-general-linear-models.html#model-selection"><i class="fa fa-check"></i><b>6.4</b> Model selection</a><ul>
<li class="chapter" data-level="6.4.1" data-path="ch-general-linear-models.html"><a href="ch-general-linear-models.html#hypothesis-testing"><i class="fa fa-check"></i><b>6.4.1</b> Hypothesis testing</a></li>
<li class="chapter" data-level="6.4.2" data-path="ch-general-linear-models.html"><a href="ch-general-linear-models.html#aic"><i class="fa fa-check"></i><b>6.4.2</b> AIC</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="ch-general-linear-models.html"><a href="ch-general-linear-models.html#diagnostics"><i class="fa fa-check"></i><b>6.5</b> Diagnostics</a><ul>
<li class="chapter" data-level="6.5.1" data-path="ch-general-linear-models.html"><a href="ch-general-linear-models.html#residuals"><i class="fa fa-check"></i><b>6.5.1</b> Residuals</a></li>
<li class="chapter" data-level="6.5.2" data-path="ch-general-linear-models.html"><a href="ch-general-linear-models.html#coefficient-of-determination-r2"><i class="fa fa-check"></i><b>6.5.2</b> Coefficient of determination, <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="ch-general-linear-models.html"><a href="ch-general-linear-models.html#model-fitting-in-r"><i class="fa fa-check"></i><b>6.6</b> Model fitting in R</a><ul>
<li class="chapter" data-level="6.6.1" data-path="ch-general-linear-models.html"><a href="ch-general-linear-models.html#linear-regression"><i class="fa fa-check"></i><b>6.6.1</b> Linear regression</a></li>
<li class="chapter" data-level="6.6.2" data-path="ch-general-linear-models.html"><a href="ch-general-linear-models.html#anova"><i class="fa fa-check"></i><b>6.6.2</b> ANOVA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch-nonlinear-models.html"><a href="ch-nonlinear-models.html"><i class="fa fa-check"></i><b>7</b> Nonlinear models</a><ul>
<li class="chapter" data-level="7.1" data-path="ch-nonlinear-models.html"><a href="ch-nonlinear-models.html#why-distinguish-between-linear-and-nonlinear-models"><i class="fa fa-check"></i><b>7.1</b> Why distinguish between linear and nonlinear models?</a></li>
<li class="chapter" data-level="7.2" data-path="ch-nonlinear-models.html"><a href="ch-nonlinear-models.html#nonnormal-errors"><i class="fa fa-check"></i><b>7.2</b> Nonnormal errors</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>8</b> Resources</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistical-tests" class="section level1">
<h1><span class="header-section-number">4</span> Statistical tests</h1>
<div id="overview-1" class="section level2">
<h2><span class="header-section-number">4.1</span> Overview</h2>
<p>A statistical test provides a framework for formally testing a hypothesis about a
population based on a sample data set collected from that population. There are
four elements of a statistical test:</p>
<ol style="list-style-type: decimal">
<li>the <strong>null hypothesis</strong>, <span class="math inline">\(H_0\)</span> - the hypothesis to be tested.</li>
<li>the <strong>alternative hypothesis</strong>, <span class="math inline">\(H_a\)</span> - the hypothesis that will be accepted
if the null hypothesis is rejected.</li>
<li>the <strong>test statistic</strong> - a function of the data used to make a decision about the
null hypothesis.</li>
<li>the <strong>p-value</strong> - a probability used to draw a conclusion about the likelihood of the
null hypothesis.</li>
</ol>
<div id="large-sample-hypothesis-testing-with-a-normally-distributed-estimator" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Large sample hypothesis testing with a normally distributed estimator</h3>
<p>Here’s an overview of the hypothesis testing framework for when you have a large
sample from a normally distributed population:</p>
<p>Suppose <span class="math inline">\(\hat{\theta}\)</span> is an estimator for a quantity of interest, <span class="math inline">\(\theta\)</span>, and that
<span class="math inline">\(\hat{\theta}\)</span> has a normal sampling distribution (approximately). A sample mean,
<span class="math inline">\(\bar{y}\)</span>, as an estimator for a population mean, is an example of an estimator that is
normally distributed. Suppose we want to test if <span class="math inline">\(\theta\)</span> is equal to a given value
<span class="math inline">\(\theta_0\)</span>. Then a general hypothesis testing procedure would look like this:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(H_0:\)</span> <span class="math inline">\(\theta = \theta_0\)</span>.</p></li>
<li><p>Pick one of these three alternative hypotheses <em>before</em> looking at your data:</p></li>
</ol>
<p><span class="math display">\[
H_a: \left\{
\begin{array}{ll}
    \theta &gt; \theta_0\text{,} &amp; \hspace{3pt} \text{upper-tail test} \\
    \theta &lt; \theta_0\text{,} &amp; \hspace{3pt} \text{lower-tail test} \\
    \theta \ne \theta_0\text{,} &amp; \hspace{3pt} \text{two-tailed test}
\end{array} 
\right. 
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li><p>Use the test statistic <span class="math inline">\(Z = \frac{\hat{\theta} - \theta_0}{\sigma_{\hat{\theta}}}\)</span>.
If the null hypothesis is true (and the underlying assumption that the estimator follows
a normal distribution is true), then <span class="math inline">\(Z\)</span> follows a standard normal distribution. For a
given sample and null hypothesis, call this calculated value <span class="math inline">\(z_{crit}\)</span>.</p></li>
<li><p>Calculate the p-value for this test, i.e., the probability of obtaining
the test statistic we got, or a more extreme value, assuming the null hypothesis is
true (we assumed <span class="math inline">\(H_0\)</span> was true and used <span class="math inline">\(\theta_0\)</span> to calculate <span class="math inline">\(z_{crit}\)</span>). The
figure below shows a normal distribution with shaded tails reflecting all of these
“more extreme” values for a two-tailed test. The shaded area gives the corresponding
p-value.</p></li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:p-value-fig"></span>
<img src="main_files/figure-html/p-value-fig-1.png" alt="A standard normal distribution with shaded tails. The shaded area gives the p-value for a two-tailed hypothesis test." width="576" />
<p class="caption">
Figure 4.1: A standard normal distribution with shaded tails. The shaded area gives the p-value for a two-tailed hypothesis test.
</p>
</div>
<p>Note that a p-value isn’t the probability that the null hypothesis is true.
In general, a “small” p-value means we would have a slim chance of getting the data
we got if the null hypothesis was true. This suggests that your assumption (that the
null hypothesis is true) is incorrect, in which case we would reject the null
hypothesis. If the p-value is “large”, we typically say that we “fail to reject the
null hypothesis” (as opposed to saying that we “accept the null hypothesis”). Whether a
p-value is “small” or “large” is subjective. The classic rule of thumb is that you
reject the null hypothesis when the p-value is less than 0.05 and fail to reject it
otherwise (in which case we say you’re using a <em>significance level</em> of 0.05). You can
always report your p-value and let your reader decide whether or not the null hypothesis
should be rejected.</p>
</div>
<div id="general-hypothesis-testing" class="section level3">
<h3><span class="header-section-number">4.1.2</span> General hypothesis testing</h3>
<p>Hypothesis testing frameworks for other non-normal estimators are similar to the one
presented here, but may have different assumptions about the sampling distribution of
the estimator and/or the data itself.</p>
</div>
</div>
<div id="single-sample-tests" class="section level2">
<h2><span class="header-section-number">4.2</span> Single sample tests</h2>
<div id="tests-for-population-mean-and-variance" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Tests for population mean and variance</h3>
<p>Most of the R functions described in this section and the following section
have default values for arguments like <code>mu</code>. We show some of those arguments explicitly
as a reminder that you can change them if needed.</p>
<strong>Z-test for a population mean:</strong>
<table style="width:100%">
<tr>
<td valign="top">
Hypotheses:
</td>
<td>
<span class="math display">\[
\text{H}_0: \mu = \mu_0. \\
H_a: \left\{
\begin{array}{ll}
    \theta &gt; \theta_0\text{,} &amp; \hspace{3pt} \text{upper-tail test} \\
    \theta &lt; \theta_0\text{,} &amp; \hspace{3pt} \text{lower-tail test} \\
    \theta \ne \theta_0\text{,} &amp; \hspace{3pt} \text{two-tailed test}
\end{array} 
\right. 
\]</span>
</td>
</tr>
<tr>
<td valign="top">
Assumptions:
</td>
<td>
<ul>
<li>Samples are independent.</li>
<li>Sample size is large (maybe &gt; 30 or so observations?).</li>
<li>Population variance is known.
</td>
</tr>
<tr>
<td>
R Function:
</td>
<td>
<code>pnorm(q, mean=0, sd=1, lower.tail=TRUE)   # single-tailed test</code>
<br>
<code>2*pnorm(q, mean=0, sd=1, lower.tail=TRUE)   # two-tailed test</code>
</td>
</tr>
<tr>
<td>
Notes:
</td>
<td>
In practice, population variance isn’t known and needs to be estimated,
so this test is rarely used. Use the t-test instead.
</td>
</tr>
</table></li>
</ul>
<p><br></p>
<strong>t-test for a population mean:</strong>
<table style="width:100%">
<tr>
<td valign="top">
Hypotheses:
</td>
<td>
<span class="math display">\[
\text{H}_0: \mu = \mu_0. \\
H_a: \left\{
\begin{array}{ll}
    \theta &gt; \theta_0\text{,} &amp; \hspace{3pt} \text{upper-tail test} \\
    \theta &lt; \theta_0\text{,} &amp; \hspace{3pt} \text{lower-tail test} \\
    \theta \ne \theta_0\text{,} &amp; \hspace{3pt} \text{two-tailed test}
\end{array} 
\right. 
\]</span>
</td>
</tr>
<tr>
<td valign="top">
Assumptions:
</td>
<td>
<ul>
<li>Samples are independent.</li>
<li>Data are normally distributed.</li>
<li>Population variance is being estimated (otherwise could use Z-test if sample size is
large enough).
</tr>
<tr>
</td>
<td>
R Function:
</td>
<td>
<code>t.test(x, alternative=alt, mu=mu, ...)</code>
</td>
</tr>
<tr>
<td>
Notes:
</td>
<td>
Fairly robust to the normality assumption.
</td>
</tr>
</table></li>
</ul>
<p><br></p>
<strong>Test for a population variance:</strong>
<table style="width:100%">
<tr>
<td valign="top">
Hypotheses:
</td>
<td>
<span class="math display">\[
\text{H}_0: \sigma^2 = \sigma_0^2. \\
H_a: \left\{
\begin{array}{ll}
    \theta &gt; \theta_0\text{,} &amp; \hspace{3pt} \text{upper-tail test} \\
    \theta &lt; \theta_0\text{,} &amp; \hspace{3pt} \text{lower-tail test} \\
    \theta \ne \theta_0\text{,} &amp; \hspace{3pt} \text{two-tailed test}
\end{array} 
\right. 
\]</span>
</td>
</tr>
<tr>
<td valign="top">
Assumptions:
</td>
<td>
<ul>
<li>Samples are independent.</li>
<li>Data are normally distributed.
</tr>
<tr>
</td>
<td>
R Function:
</td>
<td>
<code>EnvStats::varTest(x, alternative=alt, sigma.squared=sigma_0, ...)</code>
</td>
</tr>
<tr>
<td>
Notes:
</td>
<td>
Sensitive to the normality assumption.
</td>
</tr>
</table></li>
</ul>
<p><br></p>
</div>
<div id="tests-for-normality" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Tests for normality</h3>
<div id="normal-qq-plot" class="section level4 unnumbered">
<h4>1) Normal <a href="#qqplots">QQ plot</a></h4>
<p>Compare ranked sample quantiles with those from a normal distribution. The points
should fall on a straight line if the data are normally distributed. An S-shape or
banana shape may indicate nonnormality.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1">    <span class="kw">set.seed</span>(<span class="dv">4751</span>)</a>
<a class="sourceLine" id="cb58-2" data-line-number="2">    <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb58-3" data-line-number="3"></a>
<a class="sourceLine" id="cb58-4" data-line-number="4">    <span class="co"># Some example data that should theoretically pass the QQ plot normality &#39;test&#39;:</span></a>
<a class="sourceLine" id="cb58-5" data-line-number="5">    y_norm &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">200</span>, <span class="dt">mean=</span><span class="dv">50</span>, <span class="dt">sd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb58-6" data-line-number="6">    <span class="kw">qqnorm</span>(y_norm, <span class="dt">main=</span><span class="st">&quot;Normal QQ Plot: y_norm&quot;</span>)</a>
<a class="sourceLine" id="cb58-7" data-line-number="7">    <span class="kw">qqline</span>(y_norm)          <span class="co"># default distribution is normal</span></a>
<a class="sourceLine" id="cb58-8" data-line-number="8">    </a>
<a class="sourceLine" id="cb58-9" data-line-number="9">    <span class="co"># Some example data that should theoretically fail the QQ plot normality &#39;test&#39;:</span></a>
<a class="sourceLine" id="cb58-10" data-line-number="10">    y_lognorm &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(<span class="dt">n=</span><span class="dv">200</span>, <span class="dt">meanlog=</span><span class="dv">0</span>, <span class="dt">sdlog=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb58-11" data-line-number="11">    <span class="kw">qqnorm</span>(y_lognorm, <span class="dt">main=</span><span class="st">&quot;Normal QQ Plot: y_lognorm&quot;</span>)</a>
<a class="sourceLine" id="cb58-12" data-line-number="12">    <span class="kw">qqline</span>(y_lognorm)   </a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:qqplot-test"></span>
<img src="main_files/figure-html/qqplot-test-1.png" alt="Example QQ plots to investigate normality." width="768" />
<p class="caption">
Figure 4.2: Example QQ plots to investigate normality.
</p>
</div>
</div>
<div id="shapiro-wilk-normality-test" class="section level4 unnumbered">
<h4>2) Shapiro-Wilk normality test</h4>
<p>Null hypothesis: the data come from a normally distributed population.</p>
<p>Alternative hypothesis: the data do not come from a normally distributed population.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">    <span class="kw">shapiro.test</span>(y_lognorm)</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  y_lognorm
## W = 0.4148, p-value &lt; 2.2e-16</code></pre>
<p>The p-value is really small, so reject the null hypothesis that the data come from a
normally distributed population.</p>
</div>
</div>
</div>
<div id="two-sample-tests" class="section level2">
<h2><span class="header-section-number">4.3</span> Two sample tests</h2>
<strong>Fisher’s F-test to compare two population variances:</strong>
<table style="width:100%">
<tr>
<td valign="top">
Hypotheses:
</td>
<td>
<span class="math display">\[
\text{H}_0: \frac{\sigma_x}{\sigma_y} = r. \\
H_a: \left\{
\begin{array}{ll}
    \frac{\sigma_x}{\sigma_y} &gt; r \text{,} &amp; \hspace{3pt} \text{upper-tail test} \\
    \frac{\sigma_x}{\sigma_y} &lt; r \text{,} &amp; \hspace{3pt} \text{lower-tail test} \\
    \frac{\sigma_x}{\sigma_y} \ne r \text{,} &amp; \hspace{3pt} \text{two-tailed test}
\end{array} 
\right. 
\]</span>
</td>
</tr>
<tr>
<td valign="top">
Assumptions:
</td>
<td>
<ul>
<li>Samples are independent.</li>
<li>Data are normally distributed.
</tr>
<tr>
</td>
<td>
R Function:
</td>
<td>
<code>var.test(x, y, ratio=r, alternative=alt, ...)</code>
</td>
</tr>
<tr>
<td>
Notes:
</td>
<td>
Sensitive to outliers.
</td>
</tr>
</table></li>
</ul>
<p><br></p>
<strong>Student’s t-test to compare two population means (unpaired data):</strong>
<table style="width:100%">
<tr>
<td valign="top">
Hypotheses:
</td>
<td>
<span class="math display">\[
\text{H}_0: \mu_x - \mu_y = \mu. \\
H_a: \left\{
\begin{array}{ll}
    \mu_x - \mu_y &gt; \mu \text{,} &amp; \hspace{3pt} \text{upper-tail test} \\
    \mu_x - \mu_y &lt; \mu \text{,} &amp; \hspace{3pt} \text{lower-tail test} \\
    \mu_x - \mu_y \ne \mu \text{,} &amp; \hspace{3pt} \text{two-tailed test}
\end{array} 
\right. 
\]</span>
</td>
</tr>
<tr>
<td valign="top">
Assumptions:
</td>
<td>
<ul>
<li>Samples are independent.</li>
<li>Data are normally distributed.</li>
<li>Population variances are the same.
</tr>
<tr>
</td>
<td>
R Function:
</td>
<td>
<code>t.test(x, y, alternative=alt, mu=mu,</code><span style="color:blue;text-align:center;"><code>paired=FALSE</code></span><code>, ...)</code>
</td>
</tr>
</table></li>
</ul>
<p><br></p>
<strong>Wilcoxon rank-sum test to compare central locations of two samples (unpaired data):</strong>
<table style="width:100%">
<tr>
<td valign="top">
Hypotheses:
</td>
<td>
<span class="math display">\[
\text{H}_0: \text{the two distributions differ by a location shift of} \hspace{2pt} \mu.
\]</span>
</td>
</tr>
<tr>
<td valign="top">
Assumptions:
</td>
<td>
<ul>
<li>Samples are independent.</li>
<li>(Note that this doesn’t assume the data are normally distributed.)
</tr>
<tr>
</td>
<td>
R Function:
</td>
<td>
<code>wilcox.test(x, y, alternative=alt,        mu=mu,</code><span style="color:blue;text-align:center;"><code>paired=FALSE</code></span><code>, ...)</code>
</td>
</tr>
<tr>
<td>
Notes:
</td>
<td>
Non-parametric alternative to Student’s t test. Also known as Mann-Whitney test.
</td>
</tr>
</table></li>
</ul>
<p><br></p>
<strong>Paired t-test to compare means from two paired samples (paired data):</strong>
<table style="width:100%">
<tr>
<td valign="top">
Hypotheses:
</td>
<td>
<span class="math display">\[
\text{H}_0: \mu_x - \mu_y = \mu. \\
H_a: \left\{
\begin{array}{ll}
    \mu_x - \mu_y &gt; \mu \text{,} &amp; \hspace{3pt} \text{upper-tail test} \\
    \mu_x - \mu_y &lt; \mu \text{,} &amp; \hspace{3pt} \text{lower-tail test} \\
    \mu_x - \mu_y \ne \mu \text{,} &amp; \hspace{3pt} \text{two-tailed test}
\end{array} 
\right.
\]</span>
</td>
</tr>
<tr>
<td valign="top">
Assumptions:
</td>
<td>
<ul>
<li>Samples are independent.</li>
<li>Samples are paired. Samples may be paired if they are taken on the same individual or
taken from the same location.</li>
<li>The differences are normally distributed.
</tr>
<tr>
</td>
<td>
R Function:
</td>
<td>
<code>t.test(x, y, alternative=alt,      mu=mu,</code><span style="color:blue;text-align:center;"><code>paired=TRUE</code></span><code>, ...)</code>
</td>
</tr>
</table></li>
</ul>
<p><br></p>
<p>Why does it matter whether the data are paired or not? If paired data are positively
correlated, then their covariance is positive, which means the
variance used to calculate the test statistic is lower, which means it is eaiser to
detect significant differences.</p>
</div>
<div id="contingency-tables" class="section level2">
<h2><span class="header-section-number">4.4</span> Contingency tables</h2>
<p>Suppose you have count data grouped into two categories and you
want to investigate whether there is independence between the categories.</p>
<p>Null hypothesis: Category 1 is independent of Category 2.</p>
<p>Alternate hypothesis: Category 1 is not independent of Category 2.</p>
<p>Here’s an example contingency table where category 1 reflects treatment levels (
treated or untreated) for a particular condition and category 2 reflects the outcome (
either a subject’s condition improved or not):</p>
<table style="width:100%">
<tr>
<td>
</td>
<td>
Treated
</td>
<td>
Untreated
</td>
<td>
Row Totals
</td>
</tr>
<tr>
<td>
Improved
</td>
<td>
315
</td>
<td>
108
</td>
<td>
423
</td>
</tr>
<tr>
<td>
Not improved
</td>
<td>
101
</td>
<td>
32
</td>
<td>
133
</td>
</tr>
<tr>
<td>
Column Totals
</td>
<td>
416
</td>
<td>
140
</td>
<td>
556
</td>
</tr>
</table>
<p>There are several ways to calculate test statistics (this list is not exhaustive):</p>
<ul>
<li>Pearson’s chi-square: this involves calculating expected counts (E) and comparing
them to the observed counts (O) using a chi-square test statistic:
<span class="math inline">\(\chi^2 = \sum \frac{(O - E)^2}{E}\)</span>.</li>
</ul>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1">    <span class="kw">chisq.test</span>(x, y, ...)</a>
<a class="sourceLine" id="cb61-2" data-line-number="2">    <span class="kw">chisq.test</span>(x, y, <span class="dt">p=</span>p, ...)</a></code></pre></div>
<ul>
<li>Fisher’s exact test: If any of the expected frequencies is less than 4 or 5, you
should use Fisher’s exact test instead of Pearson’s chi-square test statistic. This
is because <span class="math inline">\(\chi^2\)</span>, as defined above, approximates a chi-square distribution when
the sample size is large (enough).</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">    <span class="kw">fisher.test</span>(x, y, ...)</a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="probability-distributions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistical-modeling-overview.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
